"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.securityDevicesRouter = void 0;
const express_1 = require("express");
const composition_root_1 = require("../composition-root");
const SecurityDevicesController_1 = require("../controllers/SecurityDevicesController");
const refresh_token_middleware_1 = require("../middlewares/auth/refresh-token-middleware");
exports.securityDevicesRouter = (0, express_1.Router)({});
const securityDevicesController = composition_root_1.container.resolve(SecurityDevicesController_1.SecurityDevicesController);
const refreshTokenMw = composition_root_1.container.resolve(refresh_token_middleware_1.RefreshTokenMiddleware);
exports.securityDevicesRouter.get("/", refreshTokenMw.use.bind(refreshTokenMw), securityDevicesController.getAllDevicesWithActiveSession.bind(securityDevicesController));
exports.securityDevicesRouter.delete("/", refreshTokenMw.use.bind(refreshTokenMw), securityDevicesController.deleteAllDevicesSessionsButActive.bind(securityDevicesController));
exports.securityDevicesRouter.delete("/:deviceId", refreshTokenMw.use.bind(refreshTokenMw), securityDevicesController.deleteDeviceSessionById.bind(securityDevicesController));
